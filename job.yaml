# nginxのsync前に実行されるジョブ
---
kind: Job
apiVersion: batch/v1
metadata:
  name: job
  namespace: argocd-test-nc
  labels:
    # 10より前に実行する
    argocd.argoproj.io/sync-wave: "9"
    # presync
    argocd.argoproj.io/hook: PreSync
    # 完了後に削除
    argocd.argoproj.io/hook-delete-policy: HookSucceeded

spec:
  # 適当な文字列を出力する
  template:
    spec:
      containers:
        - name: job
          image: busybox
          command: ["echo", "job"]
      restartPolicy: Never
